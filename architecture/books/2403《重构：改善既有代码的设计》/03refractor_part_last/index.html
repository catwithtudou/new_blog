
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Life">
      
      
        <meta name="author" content="catwithtudou️">
      
      
        <link rel="canonical" href="https://zhengyua.cn/new_blog/architecture/books/2403%E3%80%8A%E9%87%8D%E6%9E%84%EF%BC%9A%E6%94%B9%E5%96%84%E6%97%A2%E6%9C%89%E4%BB%A3%E7%A0%81%E7%9A%84%E8%AE%BE%E8%AE%A1%E3%80%8B/03refractor_part_last/">
      
      
        <link rel="prev" href="../02refactor_part/">
      
      
        <link rel="next" href="../04refractor_part_last_last/">
      
      
      <link rel="icon" href="../../../../assets/logo.jpeg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>09-10 - catwithtudou️🌦️</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-WZVK8HDP5T"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-WZVK8HDP5T",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-WZVK8HDP5T",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#09-10" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="catwithtudou️🌦️" class="md-header__button md-logo" aria-label="catwithtudou️🌦️" data-md-component="logo">
      
  <img src="../../../../assets/logo.jpeg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            catwithtudou️🌦️
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              09-10
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/catwithtudou" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    catwithtudou
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  🌦️Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../blog/" class="md-tabs__link">
          
  
  
    
  
  📌MainPage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../language/" class="md-tabs__link">
          
  
  
    
  
  Language

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../algorithms/" class="md-tabs__link">
          
  
  
    
  
  Algorithms

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../os/" class="md-tabs__link">
          
  
  
    
  
  OS

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../network/" class="md-tabs__link">
          
  
  
    
  
  Network

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../ds/" class="md-tabs__link">
          
  
  
    
  
  DS

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
    
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../middleware/" class="md-tabs__link">
          
  
  
    
  
  Middleware

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../project/" class="md-tabs__link">
          
  
  
    
  
  Project

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../common/01-100_tips/" class="md-tabs__link">
          
  
  
    
  
  Common

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="catwithtudou️🌦️" class="md-nav__button md-logo" aria-label="catwithtudou️🌦️" data-md-component="logo">
      
  <img src="../../../../assets/logo.jpeg" alt="logo">

    </a>
    catwithtudou️🌦️
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/catwithtudou" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    catwithtudou
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🌦️Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    📌MainPage
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../language/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Language
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../algorithms/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../os/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    OS
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../network/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Network
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../ds/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    DS
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    books
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_2" id="__nav_8_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            books
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_8_2_2" id="__nav_8_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2403《重构：改善既有代码的设计》
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_2_2">
            <span class="md-nav__icon md-icon"></span>
            2403《重构：改善既有代码的设计》
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01refactor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01-06
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02refactor_part/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07-08
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    09-10
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    09-10
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#9-重新组织数据" class="md-nav__link">
    <span class="md-ellipsis">
      9. 重新组织数据
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. 重新组织数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-拆分变量split-variable" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 拆分变量（Split Variable）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-字段改名rename-field" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 字段改名（Rename Field）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-以查询取代派生变量replace-derived-variable-with-query" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 以查询取代派生变量（Replace Derived Variable with Query）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-将引用对象改为值对象change-reference-to-value" class="md-nav__link">
    <span class="md-ellipsis">
      9.4 将引用对象改为值对象（Change Reference to Value）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95-将值对象改为引用对象change-value-to-reference" class="md-nav__link">
    <span class="md-ellipsis">
      9.5 将值对象改为引用对象（Change Value to Reference）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-简化条件逻辑" class="md-nav__link">
    <span class="md-ellipsis">
      10. 简化条件逻辑
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. 简化条件逻辑">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-分解条件表达式decompose-conditional" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 分解条件表达式（Decompose Conditional）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-合并条件表达式consolidate-conditional-expression" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 合并条件表达式（Consolidate Conditional Expression）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-以卫语句取代嵌套比条件表达式replace-nested-conditional-with-guard-clause" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 以卫语句取代嵌套比条件表达式（Replace Nested Conditional with Guard Clause）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-以多态取代条件表达式replace-conditional-with-polymorphism" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 以多态取代条件表达式（Replace Conditional with Polymorphism）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#105-引入特例introduce-special-case" class="md-nav__link">
    <span class="md-ellipsis">
      10.5 引入特例（Introduce Special Case）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#106-引入断言introduce-assertion" class="md-nav__link">
    <span class="md-ellipsis">
      10.6 引入断言（Introduce Assertion）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04refractor_part_last_last/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11-12
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../2406%E3%80%8A%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93%E3%80%8B/01init/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    2406《代码整洁之道》
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../2411%E3%80%8A%E4%BA%BA%E6%9C%88%E7%A5%9E%E8%AF%9D%E3%80%8B/01init/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    2411《人月神话》
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../2502%E3%80%8A%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%93%B2%E5%AD%A6%E3%80%8B/01init/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    2502《软件设计的哲学》
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../middleware/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Middleware
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../project/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Project
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../common/01-100_tips/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Common
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#9-重新组织数据" class="md-nav__link">
    <span class="md-ellipsis">
      9. 重新组织数据
    </span>
  </a>
  
    <nav class="md-nav" aria-label="9. 重新组织数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91-拆分变量split-variable" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 拆分变量（Split Variable）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-字段改名rename-field" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 字段改名（Rename Field）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-以查询取代派生变量replace-derived-variable-with-query" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 以查询取代派生变量（Replace Derived Variable with Query）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-将引用对象改为值对象change-reference-to-value" class="md-nav__link">
    <span class="md-ellipsis">
      9.4 将引用对象改为值对象（Change Reference to Value）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95-将值对象改为引用对象change-value-to-reference" class="md-nav__link">
    <span class="md-ellipsis">
      9.5 将值对象改为引用对象（Change Value to Reference）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-简化条件逻辑" class="md-nav__link">
    <span class="md-ellipsis">
      10. 简化条件逻辑
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10. 简化条件逻辑">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-分解条件表达式decompose-conditional" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 分解条件表达式（Decompose Conditional）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-合并条件表达式consolidate-conditional-expression" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 合并条件表达式（Consolidate Conditional Expression）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-以卫语句取代嵌套比条件表达式replace-nested-conditional-with-guard-clause" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 以卫语句取代嵌套比条件表达式（Replace Nested Conditional with Guard Clause）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#104-以多态取代条件表达式replace-conditional-with-polymorphism" class="md-nav__link">
    <span class="md-ellipsis">
      10.4 以多态取代条件表达式（Replace Conditional with Polymorphism）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#105-引入特例introduce-special-case" class="md-nav__link">
    <span class="md-ellipsis">
      10.5 引入特例（Introduce Special Case）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#106-引入断言introduce-assertion" class="md-nav__link">
    <span class="md-ellipsis">
      10.6 引入断言（Introduce Assertion）
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="09-10">09-10<a class="headerlink" href="#09-10" title="Permanent link">&para;</a></h1>
<h2 id="9-重新组织数据">9. 重新组织数据<a class="headerlink" href="#9-重新组织数据" title="Permanent link">&para;</a></h2>
<h3 id="91-拆分变量split-variable">9.1 拆分变量（Split Variable）<a class="headerlink" href="#91-拆分变量split-variable" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406060911871.png" /></p>
<ul>
<li><strong>自然被多次赋值</strong></li>
</ul>
<p>变量有各种不同的用途，其中某些用途会很自然地导致临时变量被多次赋值。</p>
<ul>
<li><strong>承担多个责任的变量</strong></li>
</ul>
<p>如果变量承担多个责任，它就应该被替换（分解）为多个变量，每个变量只承担一个责任。同一个变量承担两件不同的事情，会令代码阅读者糊涂。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>在待分解变量的声明及其第一次被赋值处，修改其名称；</li>
</ol>
<blockquote>
<p>如果稍后的赋值语句是“i=i+某表达式形式”，意味着这是一个结果收集变量，就不要分解它。结果收集变量常用于累加、字符串拼接、写入流或者向集合添加元素。</p>
</blockquote>
<ol start="2">
<li>如果可能的话，将新的变量声明为不可修改；</li>
<li>以该变量的第二次赋值动作为界，修改此前对该变量的所有引用，让它们引用新变量；</li>
<li>测试；</li>
<li>重复上述过程。每次都在声明处对变量改名，并修改下次赋值之前的引用，直至到达最后一处赋值；</li>
</ol>
</details>
<h3 id="92-字段改名rename-field">9.2 字段改名（Rename Field）<a class="headerlink" href="#92-字段改名rename-field" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406060914069.png" /></p>
<ul>
<li><strong>重要的命名</strong></li>
</ul>
<p>命名很重要，对于程序中广泛使用的记录结构，其中字段的命名格外重要。数据结构对于帮助阅读者理解特别重要。</p>
<ul>
<li><strong>保持数据结构的整洁</strong></li>
</ul>
<p>既然数据结构如此重要，就很有必要保持它们的整洁。一如既往地，若在一个软件上做的工作越多，对数据的理解就越深，所以很有必要把我加深的理解融入程序中。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>如果记录的作用域较小，可以直接修改所有该字段的代码，然后测试。后面的步骤就都不需要了；</li>
<li>如果记录还未封装，请先使用封装记录；</li>
<li>在对象内部对私有字段改名，对应调整内部访问该字段的函数；</li>
<li>测试；</li>
<li>如果构造函数的参数用了旧的字段名，运用改变函数声明将其改名；</li>
<li>运用函数改名给访问函数改名；</li>
</ol>
</details>
<h3 id="93-以查询取代派生变量replace-derived-variable-with-query">9.3 以查询取代派生变量（Replace Derived Variable with Query）<a class="headerlink" href="#93-以查询取代派生变量replace-derived-variable-with-query" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070819469.png" /></p>
<ul>
<li><strong>错误源头之可变数据</strong></li>
</ul>
<p>可变数据是软件中最大的错误源头之一。对数据的修改常常导致代码的各个部分以丑陋的形式互相耦合：在一处修改数据，却在另一处造成难以发现的破坏。</p>
<p>很多时候，完全去掉可变数据并不现实，但还是强烈建议:尽量把可变数据的作用域限制在最小范围。</p>
<ul>
<li><strong>可计算出的变量</strong></li>
</ul>
<p>有些变量其实可以很容易地随时计算出来。若能去掉这些变量，也会有助于消除可变性。</p>
<p>计算常能更清晰地表达数据的含义，而且也避免了“源数据修改时忘了更新派生变量”的错误。</p>
<ul>
<li><strong>两种不同的编程风格</strong></li>
</ul>
<p>“根据源数据生成新数据结构”的变换操作可以保持不变，即便可以将其替换为计算操作。</p>
<p>实际上，这是两种不同的编程风格：一种是对象风格，把一系列计算得出的属性包装在数据结构中；另一种是函数风格，将一个数据结构变换为另一个数据结构。</p>
<p>如果源数据会被修改，而必须负责管理派生数据结构的整个生命周期，那么对象风格显然更好。但如果源数据不可变，或者派生数据用过即弃，那么两种风格都可行。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>识别出所有对变量做更新的地方。如有必要，用拆分变量分割各个更新点；</li>
<li>新建一个函数，用于计算该变量的值；</li>
<li>用引入断言断言该变量和计算函数始终给出同样的值；</li>
</ol>
<blockquote>
<p>如有必要，用封装变量将这个断言封装起来。</p>
</blockquote>
<ol start="4">
<li>测试；</li>
<li>修改读取该变量的代码，令其调用新建的函数；</li>
<li>测试；</li>
<li>用移除死代码去掉变量的声明和赋值。</li>
</ol>
</details>
<h3 id="94-将引用对象改为值对象change-reference-to-value">9.4 将引用对象改为值对象（Change Reference to Value）<a class="headerlink" href="#94-将引用对象改为值对象change-reference-to-value" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070824778.png" /></p>
<ul>
<li><strong>引用对象与值对象的差异</strong></li>
</ul>
<p>在把一个对象（或数据结构）嵌入另一个对象时，位于内部的这个对象可以被视为引用对象，也可以被视为值对象。</p>
<p>两者最明显的差异在于如何更新内部对象的属性：如果将内部对象视为引用对象，在更新其属性时，我会保留原对象不动，更新内部对象的属性；如果将其视为值对象，我就会替换整个内部对象，新换上的对象会有我想要的属性值。</p>
<ul>
<li><strong>更容易理解的值对象不可变</strong></li>
</ul>
<p>值对象通常更容易理解，主要因为它们是不可变的。</p>
<p>一般说来，不可变的数据结构处理起来更容易。可放心地把不可变的数据值传给程序的其他部分，而不必担心对象中包装的数据被偷偷修改。可在程序各处复制值对象，而不必操心维护内存链接。</p>
<p>值对象在分布式系统和并发系统中尤为有用。</p>
<ul>
<li><strong>共享对象的修改</strong></li>
</ul>
<p>在几个对象之间共享一个对象，以便几个对象都能看见对共享对象的修改，那么这个共享的对象就应该是引用。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>检查重构目标是否为不可变对象，或者是否可修改为不可变对象；</li>
<li>用移除设值函数逐一去掉所有设值函数；</li>
<li>提供一个基于值的相等性判断函数，在其中使用值对象的字段；</li>
</ol>
<blockquote>
<p>大多数编程语言都提供了可覆写的相等性判断函数。通常你还必须同时覆写生成散列码的函数。</p>
</blockquote>
</details>
<h3 id="95-将值对象改为引用对象change-value-to-reference">9.5 将值对象改为引用对象（Change Value to Reference）<a class="headerlink" href="#95-将值对象改为引用对象change-value-to-reference" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070827980.png" /></p>
<ul>
<li><strong>复制多次带来的内存问题</strong></li>
</ul>
<p>过多的数据复制有可能会造成内存占用的问题，但就跟所有性能问题一样，这种情况并不常见。</p>
<ul>
<li><strong>复制多份的局限</strong></li>
</ul>
<p>如果共享的数据需要更新，将其复制多份的做法就会遇到巨大的困难。</p>
<p>此时必须找到所有的副本，更新所有对象。只要漏掉一个副本没有更新，就会遭遇麻烦的数据不一致。</p>
<ul>
<li><strong>某种形式的仓库</strong></li>
</ul>
<p>把值对象改为引用对象会带来一个结果：对于一个客观实体，只有一个代表它的对象。</p>
<p>这通常意味着我会需要某种形式的仓库，在仓库中可以找到所有这些实体对象。只为每个实体创建一次对象，以后始终从仓库中获取该对象。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>为相关对象创建一个仓库(如果还没有这样一个仓库的话)；</li>
<li>确保构造函数有办法找到关联对象的正确实例；</li>
<li>修改宿主对象的构造函数，令其从仓库中获取关联对象。每次修改后执行测试。</li>
</ol>
</details>
<h2 id="10-简化条件逻辑">10. 简化条件逻辑<a class="headerlink" href="#10-简化条件逻辑" title="Permanent link">&para;</a></h2>
<h3 id="101-分解条件表达式decompose-conditional">10.1 分解条件表达式（Decompose Conditional）<a class="headerlink" href="#101-分解条件表达式decompose-conditional" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070910929.png" /></p>
<ul>
<li><strong>复杂条件逻辑带来的复杂性</strong></li>
</ul>
<p>程序之中，复杂的条件逻辑是最常导致复杂度上升的地点之一。必须编写代码来检查不同的条件分支，根据不同的条件做不同的事，然后就会得到一个相当长的函数。</p>
<p>大型函数本身就会使代码的可读性下降，而条件逻辑则会使代码更难阅读。</p>
<ul>
<li><strong>分解为多个独立的函数</strong></li>
</ul>
<p>和任何大块头代码一样，可将它分解为多个独立的函数，根据每个小块代码的用途，为分解而得的新函数命名，并将原函数中对应的代码改为调用新函数，从而更清楚地表达自己的意图。</p>
<p>对于条件逻辑，将每个分支条件分解成新函数还可以带来更多好处：可以突出条件逻辑，更清楚地表明每个分支的作用，并且突出每个分支的原因。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>对条件判断和每个条件分支分别运用提炼函数手法。</li>
</ol>
</details>
<h3 id="102-合并条件表达式consolidate-conditional-expression">10.2 合并条件表达式（Consolidate Conditional Expression）<a class="headerlink" href="#102-合并条件表达式consolidate-conditional-expression" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070913571.png" /></p>
<ul>
<li><strong>逻辑或和逻辑与</strong></li>
</ul>
<p>有时会发现这样一串条件检查:检查条件各不相同，最终行为却一致。如果发现这种情况，就应该使用“逻辑或”和“逻辑与”将它们合并为一个条件表达式。</p>
<ul>
<li><strong>提炼函数解释行为</strong></li>
</ul>
<p>将检查条件提炼成一个独立的函数对于厘清代码意义非常有用，因为它把描述“做什么”的语句 换成了“为什么这样做”。</p>
<ul>
<li><strong>不合并的理由</strong></li>
</ul>
<p>条件语句的合并理由也同时指出了不要合并的理由：若我认为这些检查的确彼此独立，的确不应该被视为同一次检查，我就不会使用本项重构。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>确定这些条件表达式都没有副作用；</li>
</ol>
<blockquote>
<p>如果某个条件表达式有副作用，可以先用将查询函数和修改函数分离处理。</p>
</blockquote>
<ol start="2">
<li>使用适当的逻辑运算符，将两个相关条件表达式合并为一个；</li>
</ol>
<blockquote>
<p>顺序执行的条件表达式用逻辑或来合并，嵌套的if语句用逻辑与来合并。</p>
</blockquote>
<ol start="3">
<li>测试；</li>
<li>重复前面的合并过程，直到所有相关的条件表达式都合并到一起；</li>
<li>可以考虑对合并后的条件表达式实施提炼函数；</li>
</ol>
</details>
<h3 id="103-以卫语句取代嵌套比条件表达式replace-nested-conditional-with-guard-clause">10.3 以卫语句取代嵌套比条件表达式（Replace Nested Conditional with Guard Clause）<a class="headerlink" href="#103-以卫语句取代嵌套比条件表达式replace-nested-conditional-with-guard-clause" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070917194.png" /></p>
<ul>
<li><strong>条件表达式的风格</strong></li>
</ul>
<p>条件表达式通常有两种风格：第一种风格是两个条件分支都属于正常行为；第二种风格则是只有一个条件分支是正常行为，另一个分支则是异常的情况。</p>
<p>这两类条件表达式有不同的用途，这一点应该通过代码表现出来。</p>
<p>如果两条分支都是正常行为，就应该使用形如 if else 的条件表达式；如果某个条件极其罕见，就应该单独检查该条件，并在该条件为真时立刻从函数中返回。这样的单独检查常常被称为“卫语句”(guard clauses)。</p>
<ul>
<li><strong>给某一条分支以特别的重视</strong></li>
</ul>
<p>如果使用if-then-else结构，你对if分支和else分支的重视是同等的。这样的代码结构传递给阅读者的消息就是：各个分支有同样的重要性。</p>
<p>卫语句就不同了，它告诉阅读者:“这种情况不是本函数的核心逻辑所关心的，如果它真发生了，请做一些必要的整理工作，然后退出。”</p>
<ul>
<li><strong>优先保持代码清晰</strong></li>
</ul>
<p>在我看来，保持代码清晰才是最关键的：如果单一出口能使这个函数更清楚易读，那么就使用单一出口；否则就不必这么做。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>选中最外层需要被替换的条件逻辑，将其替换为卫语句；</li>
<li>测试；</li>
<li>有需要的话，重复上述步骤；</li>
<li>如果所有卫语句都引发同样的结果，可以使用合并条件表达式合并之；</li>
</ol>
</details>
<h3 id="104-以多态取代条件表达式replace-conditional-with-polymorphism">10.4 以多态取代条件表达式（Replace Conditional with Polymorphism）<a class="headerlink" href="#104-以多态取代条件表达式replace-conditional-with-polymorphism" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070920759.png" /></p>
<ul>
<li><strong>拆解复杂的条件逻辑</strong></li>
</ul>
<p>可将条件逻辑拆分到不同的场景（或者叫高阶用例），从而拆解复杂的条件逻辑。</p>
<p>这种拆分有时用条件逻辑本身的结构就足以表达，但使用类和多态能把逻辑的拆分表述得更清晰。</p>
<ul>
<li><strong>常见的构造场景</strong></li>
</ul>
<p>一种情况是可构造一组类型，每个类型处理各自的一种条件逻辑。最明显的征兆就是有好几个函数都有基于类型代码的switch语句。若是如此，则可针对switch语句中的每种分支逻辑创建一个类，用多态来承载各个类型特有的行为，从而去除重复的分支逻辑。</p>
<p>另一种情况是有一个基础逻辑，且其上又有一些变体。基础逻辑可能是最常用或最简单。可把基础逻辑放进超类，这样可首先理解该部分逻辑，暂时不管各种变体，然后将每种变体逻辑单独放进子类，来强调与基础逻辑的差异。</p>
<ul>
<li><strong>容易被滥用的多态</strong></li>
</ul>
<p>多态是面向对象编程的关键特性之一。跟其他一切有用的特性一样，它也很容易被滥用。但如果发现如前所述的复杂条件逻辑，多态是改善这种情况的有力工具。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>如果现有的类尚不具备多态行为，就用工厂函数创建之，令工厂函数返回恰当的对象实例；</li>
<li>在调用方代码中使用工厂函数获得对象实例；</li>
<li>将带有条件逻辑的函数移到超类中；</li>
</ol>
<blockquote>
<p>如果条件逻辑还未提炼至独立的函数，首先对其使用提炼函数。</p>
</blockquote>
<ol start="4">
<li>任选一个子类，在其中建立一个函数，使之覆写超类中容纳条件表达式的那个函数。将与该子类相关的条件表达式分支复制到新函数中，并对它进行适当调整；</li>
<li>复上述过程，处理其他条件分支；</li>
<li>在超类函数中保留默认情况的逻辑。或者，如果超类应该是抽象的，就把该函 数声明为abstract，或在其中直接抛出异常，表明计算责任都在子类中；</li>
</ol>
</details>
<h3 id="105-引入特例introduce-special-case">10.5 引入特例（Introduce Special Case）<a class="headerlink" href="#105-引入特例introduce-special-case" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070926711.png" /></p>
<ul>
<li><strong>常见的重复代码</strong></li>
</ul>
<p>一种常见的重复代码是这种情况：一个数据结构的使用者都在检查某个特殊的值，并且当这个特殊值出现时所做的处理也都相同。如果发现代码库中有多处以同样方式应对同一个特殊值，可尝试把这个处理逻辑收拢到一处。</p>
<ul>
<li><strong>使用“特例”解决重复</strong></li>
</ul>
<p>处理这种情况的一个好办法是使用“特例”（Special Case）模式：创建一个特例元素，用以表达对这种特例的共用行为的处理。 这样可用一个函数调用取代大部分特例检查逻辑。</p>
<p>一个通常需要特例处理的值就是 null，这也是这个模式常被叫作“Null 对象”（Null Object）模式。</p>
<details class="note">
<summary>具体重构步骤</summary>
<p>从一个作为容器的数据结构（或者类）开始，其中包含一个属性，该属性就是我们要重构的目标。容器的客户端每次使用这个属性时，都需要将其与某个特例值做比对。我们希望把这个特例值替换为代表这种特例情况的类或数据结构。</p>
<ol>
<li>给重构目标添加检查特例的属性，令其返回false；</li>
<li>创建一个特例对象，其中只有检查特例的属性，返回true；</li>
<li>对“与特例值做比对”的代码运用提炼函数，确保所有客户端都使用这个新函数，而不再直接做特例值的比对；</li>
<li>将新的特例对象引入代码中，可以从函数调用中返回，也可以在变换函数中生成；</li>
<li>修改特例比对函数的主体，在其中直接使用检查特例的属性；</li>
<li>测试；</li>
<li>使用函数组合成类或函数组合成变换，把通用的特例处理逻辑都搬移到新建的特例对象中；</li>
</ol>
<blockquote>
<p>特例类对于简单的请求通常会返回固定的值，因此可以将其实现为字面记录（literal record）。</p>
</blockquote>
<ol start="8">
<li>对特例比对函数使用内联函数，将其内联到仍然需要的地方；</li>
</ol>
</details>
<h3 id="106-引入断言introduce-assertion">10.6 引入断言（Introduce Assertion）<a class="headerlink" href="#106-引入断言introduce-assertion" title="Permanent link">&para;</a></h3>
<p><img alt="" src="https://img.zhengyua.cn/blog/202406070930591.png" /></p>
<ul>
<li><strong>明确假设</strong></li>
</ul>
<p>某些假设通常并没有在代码中明确表现出来，必须阅读整个算法才能看出。有时程序员会以注释写出这样的假设，而我们可使用一种更好的技术——使用断言明确标明这些假设。</p>
<ul>
<li><strong>断言在交流中的价值</strong></li>
</ul>
<p>常看见有人鼓励用断言来发现程序中的错误。这固然是一件好事，但却不是使用断言的唯一理由。</p>
<p>断言是一种很有价值的交流形式——它们告诉阅读者，程序在执行到这一点时，对当前状态做了何种假设。另外断言对调试也很有帮助。而且，因为它们在交流上很有价值，即使解决了当下正在追踪的错误，我们还是倾向于把断言留着。</p>
<p>自测试的代码降低了断言在调试方面的价值，因为逐步逼近的单元测试通常能更好地帮助调试，但我们仍然看重断言在交流方面的价值。</p>
<details class="note">
<summary>具体重构步骤</summary>
<ol>
<li>如果你发现代码假设某个条件始终为真，就加入一个断言明确说明这种情况；</li>
</ol>
<blockquote>
<p>因为断言应该不会对系统运行造成任何影响，所以“加入断言”永远都应该是 行为保持的。</p>
</blockquote>
</details>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 7, 2024 09:34:15 CST">June 7, 2024 09:34:15</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 6, 2024 09:17:16 CST">June 6, 2024 09:17:16</span>
  </span>

    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../02refactor_part/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 07-08">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                07-08
              </div>
            </div>
          </a>
        
        
          
          <a href="../04refractor_part_last_last/" class="md-footer__link md-footer__link--next" aria-label="Next: 11-12">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                11-12
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 catwithtudou
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/catwithtudou" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/catwithtudou" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.path", "navigation.prune", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "search.suggest", "search.highlight", "search.share", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.code.select", "header.autohide"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>